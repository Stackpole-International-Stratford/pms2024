{# templates/forms/bulk_add_question.html #}
{% extends "parent.html" %}

{% block content %}
<div class="container py-3">
  <h3>Add a question to selected {{ form_type.name }} forms</h3>

  <div class="alert alert-info">
    <strong>Target forms ({{ target_forms|length }}):</strong>
    <ul class="mb-0">
      {% for f in target_forms %}
        <li>{{ f.name }} (ID: {{ f.id }})</li>
      {% endfor %}
    </ul>
  </div>

  <form method="post" class="mt-3">
    {% csrf_token %}
    <input type="hidden" name="form_ids" value="{{ form_ids_csv }}">
    <input type="hidden" name="form_type" value="{{ form_type.id }}">

    {# Render fields from the selected question form class #}
    <div class="row g-3">
      {% for field in form %}
        <div class="col-12">
          <label class="form-label" for="{{ field.id_for_label }}">{{ field.label }}</label>
          {{ field }}
          {% if field.help_text %}
            <div class="form-text">{{ field.help_text }}</div>
          {% endif %}
          {% for err in field.errors %}
            <div class="text-danger small">{{ err }}</div>
          {% endfor %}
        </div>
      {% endfor %}
    </div>

    {% if form.non_field_errors %}
      <div class="alert alert-danger mt-3">
        {{ form.non_field_errors }}
      </div>
    {% endif %}

    <div class="mt-4 d-flex gap-2">
      <a class="btn btn-outline-secondary" href="{% url 'find_forms' %}?form_type={{ form_type.id }}">Cancel</a>
      <button type="submit" class="btn btn-primary">Add Question to All Selected</button>
    </div>
  </form>
</div>
{% endblock %}
