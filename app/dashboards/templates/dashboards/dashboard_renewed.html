{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Dashboard — {{ page }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS (served locally via static files) -->
    <link href="{% static 'bootstrap/css/bootstrap.min.css' %}" rel="stylesheet" />

    <style>
      /* Shrink table cell padding so more cells fit on-screen */
      .table td, .table th {
        padding: 0.25rem 0.5rem;
        font-size: 0.85rem;
      }
      /* Slightly larger text for program headers */
      .program-header {
        font-size: 1.1rem;
        font-weight: bold;
      }
      /* Light border and background for each program panel */
      .program-col {
        border: 1px solid #dee2e6;
        background-color: #f8f9fa;
      }
      /* Operation-cell style (leftmost cell) */
      .op-cell {
        background-color: #e9ecef;
        font-weight: 600;
        text-align: center;
        vertical-align: middle;
      }
    </style>
</head>
<body>
  <div class="container-fluid mt-2">
    <div class="row no-gutters">
      {# Loop over each program #}
      {% for prog in programs %}
        <div class="col-sm-6 col-md-4 col-lg-3 px-1 mb-2 program-col d-flex flex-column">
          {# Program Header #}
          <div class="bg-secondary text-white text-center py-1 program-header">
            {{ prog.program }}
          </div>

          {# Loop over lines within this program #}
          {% for line in prog.lines %}
            <div class="w-100 mt-1">
              {# Line Name #}
              <div class="bg-light text-center font-weight-bold py-1">
                {{ line.line }}
              </div>
              {# Operation→Machine table #}
              <div class="table-responsive">
                <table class="table table-bordered table-sm mb-1">
                  <tbody>
                    {% for op in line.operations %}
                      <tr>
                        <td class="op-cell">{{ op.op }}</td>
                        {% if op.machines %}
                          {% for m in op.machines %}
                            <td class="text-center align-middle">
                              <div>{{ m.number }}</div>
                              <div class="small text-muted">
                                {{ m.count }}
                              </div>
                            </td>
                          {% endfor %}
                        {% else %}
                          {# If no machines for this OP → one empty cell #}
                          <td class="text-center align-middle text-muted">
                            —
                          </td>
                        {% endif %}
                      </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>
            </div>
          {% endfor %}

          {# Push any remaining space to bottom #}
          <div class="mt-auto"></div>
        </div>
      {% endfor %}
    </div>
  </div>

  <!-- Bootstrap JS Bundle (served via static files) -->
  <script src="{% static 'bootstrap/js/bootstrap.bundle.min.js' %}"></script>
</body>
</html>
